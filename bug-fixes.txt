this is bug fixes in main branch 